{% extends "base.html" %}

{% block title %}Achievements - Case Clicker{% endblock %}

{% block content %}
<style>
    .achievements-container {
        padding: 20px;
        max-width: 1200px;
        margin: 0 auto;
    }

    .achievements-header {
        text-align: center;
        margin-bottom: 30px;
        color: #ffd700;
    }

    .achievements-header h1 {
        font-size: 2.5em;
        margin-bottom: 10px;
    }

    .achievements-header p {
        color: #888;
        font-size: 1.1em;
    }

    .achievements-grid {
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
        gap: 20px;
        padding: 20px;
    }

    .achievement-card {
        background: linear-gradient(145deg, #2a2a2a, #1a1a1a);
        border-radius: 10px;
        padding: 20px;
        position: relative;
        transition: transform 0.3s ease, box-shadow 0.3s ease;
        border: 1px solid #333;
        overflow: hidden;
    }

    .achievement-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
    }

    .achievement-card.locked {
        filter: grayscale(100%);
        opacity: 0.7;
    }

    .achievement-card.locked::after {
        content: 'ðŸ”’';
        position: absolute;
        top: 10px;
        right: 10px;
        font-size: 20px;
    }

    .achievement-icon {
        width: 50px;
        height: 50px;
        margin-bottom: 15px;
        background: #333;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 24px;
    }

    .achievement-title {
        font-size: 1.2em;
        color: #ffd700;
        margin-bottom: 10px;
        font-weight: bold;
    }

    .achievement-description {
        color: #aaa;
        font-size: 0.9em;
        margin-bottom: 15px;
    }

    .achievement-progress {
        background: #333;
        height: 6px;
        border-radius: 3px;
        overflow: hidden;
        margin-top: 10px;
    }

    .achievement-progress-bar {
        height: 100%;
        background: linear-gradient(90deg, #ffd700, #ff9900);
        transition: width 0.3s ease;
    }

    .achievement-stats {
        display: flex;
        justify-content: space-between;
        margin-top: 15px;
        font-size: 0.8em;
        color: #666;
        align-items: flex-end;
    }

    .achievement-reward {
        color: #4CAF50;
    }

    .achievements-summary {
        background: linear-gradient(145deg, #2a2a2a, #1a1a1a);
        border-radius: 10px;
        padding: 20px;
        margin-bottom: 30px;
        display: flex;
        justify-content: space-around;
        align-items: center;
        border: 1px solid #333;
    }

    .summary-stat {
        text-align: center;
    }

    .summary-stat h3 {
        color: #ffd700;
        font-size: 1.8em;
        margin-bottom: 5px;
    }

    .summary-stat p {
        color: #888;
        font-size: 0.9em;
    }

    .category-filter {
        display: flex;
        justify-content: center;
        gap: 15px;
        margin-bottom: 30px;
        flex-wrap: wrap;
    }

    .category-btn {
        background: #333;
        border: none;
        padding: 10px 20px;
        border-radius: 20px;
        color: #fff;
        cursor: pointer;
        transition: all 0.3s ease;
    }

    .category-btn:hover {
        background: #444;
    }

    .category-btn.active {
        background: #ffd700;
        color: #000;
    }

    @keyframes unlock {
        0% { transform: scale(1); }
        50% { transform: scale(1.1); }
        100% { transform: scale(1); }
    }

    .achievement-card.just-unlocked {
        animation: unlock 0.5s ease;
        border-color: #ffd700;
    }

    .achievement-rewards {
        display: flex;
        flex-direction: column;
        align-items: flex-end;
        gap: 5px;
    }

    .achievement-reward {
        font-size: 0.9em;
        padding: 2px 8px;
        border-radius: 10px;
        display: inline-flex;
        align-items: center;
        gap: 4px;
    }

    .achievement-reward.money {
        color: #4CAF50;
        background: rgba(76, 175, 80, 0.1);
    }

    .achievement-reward.exp {
        color: #FF9800;
        background: rgba(255, 152, 0, 0.1);
    }
</style>

<div class="achievements-container">
    <div class="achievements-header">
        <h1>Achievements</h1>
        <p>Track your progress and earn rewards</p>
    </div>

    <div class="achievements-summary">
        <div class="summary-stat">
            <h3>{{ completed_count }}/{{ total_count }}</h3>
            <p>Achievements Completed</p>
        </div>
        <div class="summary-stat">
            <h3>{{ completion_rate }}%</h3>
            <p>Completion Rate</p>
        </div>
        <div class="summary-stat">
            <h3>${{ '{:,.0f}'.format(total_rewards) }}</h3>
            <p>Total Rewards Earned</p>
        </div>
    </div>

    <div class="category-filter">
        <button class="category-btn active" data-category="all">All</button>
        <button class="category-btn" data-category="cases">Cases</button>
        <button class="category-btn" data-category="trading">Trading</button>
        <button class="category-btn" data-category="casino">Casino</button>
        <button class="category-btn" data-category="clicker">Clicker</button>
        <button class="category-btn" data-category="inventory">Inventory</button>
        <button class="category-btn" data-category="special">Special</button>
        <button class="category-btn" data-category="completed">Completed</button>
    </div>

    <div class="achievements-grid">
        {% for achievement in achievements %}
        <div class="achievement-card {% if not achievement.completed %}locked{% endif %}" 
             data-category="{{ 'completed' if achievement.completed else achievement.category }}">
            <div class="achievement-icon">{{ achievement.icon }}</div>
            <div class="achievement-title">{{ achievement.title }}</div>
            <div class="achievement-description">{{ achievement.description }}</div>
            <div class="achievement-progress">
                <div class="achievement-progress-bar" style="width: {{ achievement.progress }}%"></div>
            </div>
            <div class="achievement-stats">
                <span>{{ '{:,.0f}'.format(achievement.current_value) }}/{{ '{:,.0f}'.format(achievement.target_value) }}</span>
                <div class="achievement-rewards">
                    <span class="achievement-reward money">ðŸ’° ${{ '{:,.0f}'.format(achievement.reward) }}</span>
                    <span class="achievement-reward exp">âœ¨ {{ '{:,.0f}'.format(achievement.exp_reward) }} EXP</span>
                </div>
            </div>
        </div>
        {% endfor %}
    </div>
</div>

<script>
document.addEventListener('DOMContentLoaded', function() {
    const categoryButtons = document.querySelectorAll('.category-btn');
    const achievementCards = document.querySelectorAll('.achievement-card');

    // Function to filter achievements
    function filterAchievements(category) {
        achievementCards.forEach(card => {
            if (category === 'all' && card.dataset.category !== 'completed') {
                card.style.display = 'block';
            } else if (category !== 'all' && card.dataset.category === category) {
                card.style.display = 'block';
            } else {
                card.style.display = 'none';
            }
        });
    }

    categoryButtons.forEach(button => {
        button.addEventListener('click', () => {
            // Remove active class from all buttons
            categoryButtons.forEach(btn => btn.classList.remove('active'));
            // Add active class to clicked button
            button.classList.add('active');

            const category = button.dataset.category;
            filterAchievements(category);
        });
    });

    // Initial filtering for 'all' category on page load
    filterAchievements('all');
});
</script>
{% endblock %} 